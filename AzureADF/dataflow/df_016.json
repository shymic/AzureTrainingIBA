{
	"name": "df_016",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference"
					},
					"name": "V175S1P2"
				},
				{
					"dataset": {
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference"
					},
					"name": "V175S4P2"
				},
				{
					"dataset": {
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference"
					},
					"name": "V175S1P1"
				},
				{
					"dataset": {
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference"
					},
					"name": "V0S68P2"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ds_sinkTable",
						"type": "DatasetReference"
					},
					"name": "V175S6",
					"description": "DB2_Connector_67"
				}
			],
			"transformations": [
				{
					"name": "V175S2P1Join",
					"description": "Join_119"
				},
				{
					"name": "V175S2P1",
					"description": "Join_119"
				},
				{
					"name": "V175S4P1Derive",
					"description": "Copy_3_of_Transformer_78"
				},
				{
					"name": "V175S4P1",
					"description": "Copy_3_of_Transformer_78"
				},
				{
					"name": "V175S5P1Join",
					"description": "Join_136"
				},
				{
					"name": "V175S5P1",
					"description": "Join_136"
				},
				{
					"name": "V0S68P1",
					"description": "Transformer_39"
				},
				{
					"name": "V175S6P2",
					"description": "Remove_Duplicates_67"
				},
				{
					"name": "V0S67P2",
					"description": "Funnel_68"
				}
			],
			"scriptLines": [
				"parameters{",
				"     p_IPPF_RULES_SCHEME1 as string",
				"}",
				"source(output(",
				"          SAP_CMPNY_CD1 as string,",
				"          COMPANY_CD as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     maxColumns: 200) ~> V175S1P2",
				"source(output(",
				"          COUNTRY_CD as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     maxColumns: 200) ~> V175S4P2",
				"source(output(",
				"          COUNTRY_CD as string,",
				"          COMPANY_CD as string,",
				"          LEDGER_CD as string,",
				"          STATUS as string,",
				"          COMPANY_DESC as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     maxColumns: 200) ~> V175S1P1",
				"source(output(",
				"          COUNTRY as string,",
				"          COMPANY as string,",
				"          LEDGER_CODE as string,",
				"          STATUS as string,",
				"          NAME as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     maxColumns: 200) ~> V0S68P2",
				"V175S1P1, V175S1P2 join(V175S1P1@COMPANY_CD == V175S1P2@COMPANY_CD,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> V175S2P1Join",
				"V175S2P1Join select(mapColumn(",
				"          COUNTRY_CD,",
				"          COMPANY_CD = V175S1P1@COMPANY_CD,",
				"          LEDGER_CD,",
				"          STATUS,",
				"          COMPANY_DESC,",
				"          SAP_CMPNY_CD1",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> V175S2P1",
				"V175S2P1 derive(COUNTRY_CD = case(!isNull(SAP_CMPNY_CD1) ,SAP_CMPNY_CD1,COUNTRY_CD)) ~> V175S4P1Derive",
				"V175S4P1Derive select(mapColumn(",
				"          COUNTRY_CD,",
				"          COMPANY_CD,",
				"          LEDGER_CD,",
				"          STATUS,",
				"          COMPANY_DESC",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> V175S4P1",
				"V175S4P1, V175S4P2 join(V175S4P1@COUNTRY_CD == V175S4P2@COUNTRY_CD,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> V175S5P1Join",
				"V175S5P1Join select(mapColumn(",
				"          COUNTRY_CD = V175S4P1@COUNTRY_CD,",
				"          COMPANY_CD,",
				"          LEDGER_CD,",
				"          STATUS,",
				"          COMPANY_DESC",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> V175S5P1",
				"V175S5P1 select(mapColumn(",
				"          COUNTRY = COUNTRY_CD,",
				"          COMPANY = COMPANY_CD,",
				"          LEDGER_CODE = LEDGER_CD,",
				"          STATUS,",
				"          NAME = COMPANY_DESC",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> V0S68P1",
				"V0S67P2 aggregate(groupBy(COUNTRY,",
				"          COMPANY),",
				"     each(match(name!='COUNTRY'&&name!='COMPANY'), $$ = first($$))) ~> V175S6P2",
				"V0S68P2, V0S68P1 union(byName: true)~> V0S67P2",
				"V175S6P2 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     preSQLs:[(\"DELETE FROM \" + $p_IPPF_RULES_SCHEME1 + \".COMPANIES WHERE 1=1\")],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError') ~> V175S6"
			]
		}
	}
}