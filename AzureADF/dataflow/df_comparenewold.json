{
	"name": "df_comparenewold",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "CSV_fc",
						"type": "DatasetReference"
					},
					"name": "New"
				},
				{
					"dataset": {
						"referenceName": "CSV_fc_current",
						"type": "DatasetReference"
					},
					"name": "Existing"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "ExistingHash"
				},
				{
					"name": "NewHash"
				},
				{
					"name": "exists1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          {WBS ID} as string,",
				"          {Entity type} as string,",
				"          Country as string,",
				"          Brand as string,",
				"          {Profit center description} as string,",
				"          {IPPF sector (brand)} as string,",
				"          {IPPF sector (S&D)} as string,",
				"          {IPPF sector (local)} as string,",
				"          {IPPF sector (GB overlay) code} as string,",
				"          {IPPF sector (GB overlay)} as string,",
				"          {IPPF industry S&D} as string,",
				"          {IPPF industry local} as string,",
				"          {Service line} as string,",
				"          Practice as string,",
				"          LOB as string,",
				"          {GBS Growth platform} as string,",
				"          {CPM Exception date} as string,",
				"          {CPM Exception reason} as string,",
				"          {GBS Solution handover required} as string,",
				"          {GBS CPM required} as string,",
				"          {GBS Quality partner reviews} as string,",
				"          {GBS Global quality SQUAD intervention} as string,",
				"          {GBS Harvest estimates} as string,",
				"          Geo as string,",
				"          Market as string,",
				"          {Sub market} as string,",
				"          {WBS short description} as string,",
				"          {WBS start date} as string,",
				"          {WBS end date} as string,",
				"          {WBS created date} as string,",
				"          {PCW conversion date} as string,",
				"          {RA key} as string,",
				"          {Forecast draft status} as string,",
				"          {Forecast workflow status} as string,",
				"          {Forecast processing status} as string,",
				"          {Forecast override status} as string,",
				"          {Forecast submitter Notes ID} as string,",
				"          {Forecast submission timestamp} as string,",
				"          {Forecast method} as string,",
				"          {Last SCMgrtimestamp} as string,",
				"          {Reconcilliation eligibility} as string,",
				"          {Reconcilliation status} as string,",
				"          {Reconcilliation Notes ID} as string,",
				"          {Reconcilliation timestamp} as string,",
				"          {Forecast last approved timestamp} as string,",
				"          {Process indicator} as string,",
				"          {IPPF customer} as string,",
				"          {IPPF customer number} as string,",
				"          {Global buying group} as string,",
				"          Cluster as string,",
				"          {Cluster leader Notes ID} as string,",
				"          {Account classification} as string,",
				"          {Local named account} as string,",
				"          {System contract number} as string,",
				"          {Legal contract number} as string,",
				"          {Account brand} as string,",
				"          {Account brand description} as string,",
				"          {Account brand system status} as string,",
				"          {Sub cluster} as string,",
				"          {Dilutive account} as string,",
				"          {I-deal} as string,",
				"          {Portfolio account} as string,",
				"          {T&T focus account} as string,",
				"          {Tail account} as string,",
				"          {Account focus description} as string,",
				"          {Account focus value} as string,",
				"          {Account project executive} as string,",
				"          {Account delivery project executive} as string,",
				"          {Account financial analyst} as string,",
				"          {WBS IPPF status} as string,",
				"          {PE Notes ID} as string,",
				"          {Brand PE Notes ID} as string,",
				"          {Brand PE delegate(s) Notes ID} as string,",
				"          {PM Notes ID} as string,",
				"          {PM delegate(s) Notes ID} as string,",
				"          {IPPF AP51 indicator} as string,",
				"          {POC assist availability} as string,",
				"          {Revenue update method} as string,",
				"          {IPPF POC indicator} as string,",
				"          {Forecast currency} as string,",
				"          {Billing currency} as string,",
				"          {TCV (Plan Rate USD)} as string,",
				"          {Plan type} as string,",
				"          {Plan revenue} as string,",
				"          {Plan cost} as string,",
				"          {Plan GP} as string,",
				"          {Plan GP %} as string,",
				"          {ITD revenue} as string,",
				"          {ITD cost} as string,",
				"          {ITD GP} as string,",
				"          {ITD GP%} as string,",
				"          {EaC revenue} as string,",
				"          {EaC cost} as string,",
				"          {EaC GP} as string,",
				"          {EaC GP %} as string,",
				"          {Variance EaC to plan revenue} as string,",
				"          {Variance EaC to plan cost} as string,",
				"          {Override justification} as string,",
				"          {Consolidation level} as string,",
				"          {Consolidation level description} as string,",
				"          {Contract phase} as string,",
				"          {Forecast eligibility status} as string,",
				"          {PM forecast comments} as string,",
				"          {IPPF Geography business organization} as string,",
				"          {WBS short ID} as string,",
				"          {Certified backlog (Plan USD)} as string,",
				"          {IPPF T&M indicator} as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     maxColumns: 200) ~> New",
				"source(output(",
				"          {WBS ID} as string,",
				"          {Entity type} as string,",
				"          Country as string,",
				"          Brand as string,",
				"          {Profit center description} as string,",
				"          {IPPF sector (brand)} as string,",
				"          {IPPF sector (S&D)} as string,",
				"          {IPPF sector (local)} as string,",
				"          {IPPF sector (GB overlay) code} as string,",
				"          {IPPF sector (GB overlay)} as string,",
				"          {IPPF industry S&D} as string,",
				"          {IPPF industry local} as string,",
				"          {Service line} as string,",
				"          Practice as string,",
				"          LOB as string,",
				"          {GBS Growth platform} as string,",
				"          {CPM Exception date} as string,",
				"          {CPM Exception reason} as string,",
				"          {GBS Solution handover required} as string,",
				"          {GBS CPM required} as string,",
				"          {GBS Quality partner reviews} as string,",
				"          {GBS Global quality SQUAD intervention} as string,",
				"          {GBS Harvest estimates} as string,",
				"          Geo as string,",
				"          Market as string,",
				"          {Sub market} as string,",
				"          {WBS short description} as string,",
				"          {WBS start date} as string,",
				"          {WBS end date} as string,",
				"          {WBS created date} as string,",
				"          {PCW conversion date} as string,",
				"          {RA key} as string,",
				"          {Forecast draft status} as string,",
				"          {Forecast workflow status} as string,",
				"          {Forecast processing status} as string,",
				"          {Forecast override status} as string,",
				"          {Forecast submitter Notes ID} as string,",
				"          {Forecast submission timestamp} as string,",
				"          {Forecast method} as string,",
				"          {Last SCMgrtimestamp} as string,",
				"          {Reconcilliation eligibility} as string,",
				"          {Reconcilliation status} as string,",
				"          {Reconcilliation Notes ID} as string,",
				"          {Reconcilliation timestamp} as string,",
				"          {Forecast last approved timestamp} as string,",
				"          {Process indicator} as string,",
				"          {IPPF customer} as string,",
				"          {IPPF customer number} as string,",
				"          {Global buying group} as string,",
				"          Cluster as string,",
				"          {Cluster leader Notes ID} as string,",
				"          {Account classification} as string,",
				"          {Local named account} as string,",
				"          {System contract number} as string,",
				"          {Legal contract number} as string,",
				"          {Account brand} as string,",
				"          {Account brand description} as string,",
				"          {Account brand system status} as string,",
				"          {Sub cluster} as string,",
				"          {Dilutive account} as string,",
				"          {I-deal} as string,",
				"          {Portfolio account} as string,",
				"          {T&T focus account} as string,",
				"          {Tail account} as string,",
				"          {Account focus description} as string,",
				"          {Account focus value} as string,",
				"          {Account project executive} as string,",
				"          {Account delivery project executive} as string,",
				"          {Account financial analyst} as string,",
				"          {WBS IPPF status} as string,",
				"          {PE Notes ID} as string,",
				"          {Brand PE Notes ID} as string,",
				"          {Brand PE delegate(s) Notes ID} as string,",
				"          {PM Notes ID} as string,",
				"          {PM delegate(s) Notes ID} as string,",
				"          {IPPF AP51 indicator} as string,",
				"          {POC assist availability} as string,",
				"          {Revenue update method} as string,",
				"          {IPPF POC indicator} as string,",
				"          {Forecast currency} as string,",
				"          {Billing currency} as string,",
				"          {TCV (Plan Rate USD)} as string,",
				"          {Plan type} as string,",
				"          {Plan revenue} as string,",
				"          {Plan cost} as string,",
				"          {Plan GP} as string,",
				"          {Plan GP %} as string,",
				"          {ITD revenue} as string,",
				"          {ITD cost} as string,",
				"          {ITD GP} as string,",
				"          {ITD GP%} as string,",
				"          {EaC revenue} as string,",
				"          {EaC cost} as string,",
				"          {EaC GP} as string,",
				"          {EaC GP %} as string,",
				"          {Variance EaC to plan revenue} as string,",
				"          {Variance EaC to plan cost} as string,",
				"          {Override justification} as string,",
				"          {Consolidation level} as string,",
				"          {Consolidation level description} as string,",
				"          {Contract phase} as string,",
				"          {Forecast eligibility status} as string,",
				"          {PM forecast comments} as string,",
				"          {IPPF Geography business organization} as string,",
				"          {WBS short ID} as string,",
				"          {Certified backlog (Plan USD)} as string,",
				"          {IPPF T&M indicator} as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     maxColumns: 200) ~> Existing",
				"Existing derive(CurrHash = sha256({WBS ID},{Entity type},Country,Brand,{Profit center description},{IPPF sector (brand)},{IPPF sector (S&D)},{IPPF sector (local)})) ~> ExistingHash",
				"New derive(SourceHash = sha256({WBS ID},{Entity type},Country,Brand,{Profit center description},{IPPF sector (brand)},{IPPF sector (S&D)},{IPPF sector (local)})) ~> NewHash",
				"NewHash, ExistingHash exists(SourceHash == CurrHash,",
				"     negate:true,",
				"     broadcast: 'auto')~> exists1"
			]
		}
	}
}