{
	"name": "df_083",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference"
					},
					"name": "V160S1P2"
				},
				{
					"dataset": {
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference"
					},
					"name": "V160S4P2"
				},
				{
					"dataset": {
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference"
					},
					"name": "V160S1P1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ds_sinkTable",
						"type": "DatasetReference"
					},
					"name": "V160S6",
					"description": "STAG_WORK_ITEM_LOAD"
				}
			],
			"transformations": [
				{
					"name": "V160S2P1Join",
					"description": "join - DS V160S1"
				},
				{
					"name": "V160S2P1",
					"description": "select  - DS V160S1"
				},
				{
					"name": "V160S4P1Derive",
					"description": "derive - DS V160S2"
				},
				{
					"name": "V160S4P1",
					"description": "select  - DS V160S2"
				},
				{
					"name": "V160S5P1Join",
					"description": "join - DS V160S4"
				},
				{
					"name": "V160S5P1",
					"description": "select  - DS V160S4"
				},
				{
					"name": "V160S7P1",
					"description": "aggregate - DS V160S5"
				},
				{
					"name": "V160S6P1",
					"description": "select  - DS V160S7"
				}
			],
			"scriptLines": [
				"source(output(",
				"          WBS_ID as string,",
				"          SAP_CMPNY_CD1 as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     maxColumns: 200) ~> V160S1P2",
				"source(output(",
				"          SAP_CMPNY_CD as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     maxColumns: 200) ~> V160S4P2",
				"source(output(",
				"          WRK_ITM as string,",
				"          WRK_ITM_DESC as string,",
				"          WBS_ID as string,",
				"          SAP_CMPNY_CD as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     maxColumns: 200) ~> V160S1P1",
				"V160S1P2, V160S1P1 join(V160S1P2@WBS_ID == V160S1P1@WBS_ID,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> V160S2P1Join",
				"V160S2P1Join select(mapColumn(",
				"          WRK_ITM,",
				"          WRK_ITM_DESC,",
				"          WBS_ID = V160S1P1@WBS_ID,",
				"          SAP_CMPNY_CD,",
				"          SAP_CMPNY_CD1",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> V160S2P1",
				"V160S2P1 derive(SAP_CMPNY_CD = case(!isNull(SAP_CMPNY_CD1) ,SAP_CMPNY_CD1,SAP_CMPNY_CD)) ~> V160S4P1Derive",
				"V160S4P1Derive select(mapColumn(",
				"          WRK_ITM,",
				"          WRK_ITM_DESC,",
				"          WBS_ID,",
				"          SAP_CMPNY_CD",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> V160S4P1",
				"V160S4P1, V160S4P2 join(V160S4P1@SAP_CMPNY_CD == V160S4P2@SAP_CMPNY_CD,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> V160S5P1Join",
				"V160S5P1Join select(mapColumn(",
				"          WRK_ITM,",
				"          WRK_ITM_DESC,",
				"          WBS_ID,",
				"          SAP_CMPNY_CD = V160S4P1@SAP_CMPNY_CD",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> V160S5P1",
				"V160S5P1 aggregate(groupBy(WRK_ITM,",
				"          WBS_ID),",
				"     each(match(name!='WRK_ITM'&&name!='WBS_ID'), $$ = first($$))) ~> V160S7P1",
				"V160S7P1 select(mapColumn(",
				"          WRK_ITM,",
				"          WRK_ITM_DESC,",
				"          WBS_ID",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> V160S6P1",
				"V160S6P1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     preSQLs:['TRUNCATE TABLE STAG.WORK_ITEM_LOAD DROP STORAGE IMMEDIATE'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError') ~> V160S6"
			]
		}
	}
}