{
	"name": "df_031",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference"
					},
					"name": "V0S68P1"
				},
				{
					"dataset": {
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference"
					},
					"name": "V0S67P1"
				},
				{
					"dataset": {
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference"
					},
					"name": "V0S67P6"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ds_sinkTable",
						"type": "DatasetReference"
					},
					"name": "V79S2",
					"description": "LIPPF_POC_INDICATOR_LOAD"
				}
			],
			"transformations": [
				{
					"name": "V79S2P1",
					"description": "Transformer_39"
				},
				{
					"name": "V0S68P2Join",
					"description": "Join_67"
				},
				{
					"name": "V0S68P2",
					"description": "Join_67"
				},
				{
					"name": "V79S0P3",
					"description": "Funnel_68"
				}
			],
			"scriptLines": [
				"parameters{",
				"     p_IPPF_RULES_SCHEME as string",
				"}",
				"source(output(",
				"          WBS_ID as string,",
				"          CNTRY as string,",
				"          WBS_LVL_NUM as decimal(2,1),",
				"          AP51_IND as string,",
				"          POC_IND as string,",
				"          RISC_IND as string,",
				"          CLOSED_IND as string,",
				"          UOA as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     maxColumns: 200) ~> V0S68P1",
				"source(output(",
				"          WBS_ID as string,",
				"          CONTRACT_NBR as string,",
				"          TOA as string,",
				"          CNTRY as string,",
				"          WBS_LVL_NUM as decimal(2,1),",
				"          AP51_IND as string,",
				"          POC_IND as string,",
				"          RISC_IND as string,",
				"          CLOSED_IND as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     maxColumns: 200) ~> V0S67P1",
				"source(output(",
				"          WBS_ID as string,",
				"          CONTRACT_NBR as string,",
				"          TOA as string,",
				"          CNTRY as string,",
				"          WBS_LVL_NUM as decimal(2,1),",
				"          AP51_IND as string,",
				"          POC_IND as string,",
				"          RISC_IND as string,",
				"          CLOSED_IND as string,",
				"          UOA as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     maxColumns: 200) ~> V0S67P6",
				"V79S0P3 select(mapColumn(",
				"          WBS_ID,",
				"          CNTRY,",
				"          WBS_LVL_NUM,",
				"          AP51_IND,",
				"          POC_IND,",
				"          RISC_IND,",
				"          CLOSED_IND,",
				"          UOA",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> V79S2P1",
				"V0S67P1, V0S67P6 join(V0S67P1@WBS_ID == V0S67P6@WBS_ID,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> V0S68P2Join",
				"V0S68P2Join select(mapColumn(",
				"          WBS_ID = V0S67P1@WBS_ID,",
				"          CNTRY,",
				"          WBS_LVL_NUM,",
				"          AP51_IND,",
				"          POC_IND,",
				"          RISC_IND,",
				"          CLOSED_IND,",
				"          UOA",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> V0S68P2",
				"V0S68P2, V0S68P1 union(byName: true)~> V79S0P3",
				"V79S2P1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     preSQLs:[(\"DELETE FROM \" + $p_IPPF_RULES_SCHEME + \".POC_INDICATOR_LOAD\")],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError') ~> V79S2"
			]
		}
	}
}