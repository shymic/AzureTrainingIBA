{
	"name": "pl_009",
	"properties": {
		"activities": [
			{
				"name": "V164S6P1",
				"description": "BLUEPP_WBS_PLANNING",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "Db2Source",
						"query": {
							"value": "select      t3.WBS_ID     as WBS_ID,     t3.COST_ELEM_CD   as COST_ELEM_CD,     sum(t3.WBS_ELEM_OC_AMT) as WBS_ELEM_OC_AMT,     sum(t3.WBS_ELEM_CC_AMT) as WBS_ELEM_CC_AMT,     max(t3.OBJ_CRNCY_CD)  as OBJ_CRNCY_CD,     max(t3.CNTRL_CRNCY_CD) as CNTRL_CRNCY_CD,     t3.MONTH_NUM   as MONTH_NUM,     t3.YEAR_NUM    as YEAR_NUM,     t3.WBS_LVL_NUM    as WBS_LVL_NUM     from ( select     t2.WBS_ID,     t2.COST_ELEM_CD,     t2.TXN_CRNCY_CD as OBJ_CRNCY_CD,     'USD' as CNTRL_CRNCY_CD,     t2.a1 as MONTH_NUM,     t2.FSCL_YR_NUM as YEAR_NUM,     t2.LVL_NUM as WBS_LVL_NUM,  case    when a1=1 then  P01_TOT_VAL   when a1 =2 then P02_TOT_VAL   when a1 =3 then P03_TOT_VAL   when a1 =4 then P04_TOT_VAL   when a1 =5 then P05_TOT_VAL   when a1 =6 then P06_TOT_VAL   when a1 =7 then P07_TOT_VAL   when a1 =8 then P08_TOT_VAL   when a1 =9 then P09_TOT_VAL   when a1 =10 then P10_TOT_VAL   when a1 =11 then P11_TOT_VAL   when a1 =12 then P12_TOT_VAL   else null  end as WBS_ELEM_OC_AMT,  case    when a1 =1  then P01_TOT_CNTLNG_VAL   when a1 =2  then P02_TOT_CNTLNG_VAL   when a1 =3  then P03_TOT_CNTLNG_VAL   when a1 =4  then P04_TOT_CNTLNG_VAL   when a1 =5  then P05_TOT_CNTLNG_VAL   when a1 =6  then P06_TOT_CNTLNG_VAL   when a1 =7  then P07_TOT_CNTLNG_VAL   when a1 =8  then P08_TOT_CNTLNG_VAL   when a1 =9  then P09_TOT_CNTLNG_VAL   when a1 =10 then P10_TOT_CNTLNG_VAL   when a1 =11 then P11_TOT_CNTLNG_VAL   when a1 =12 then P12_TOT_CNTLNG_VAL   else null  end as WBS_ELEM_CC_AMT from ( SELECT t.a1,we.LVL_NUM, wp.*  FROM BLUEPP.WBS_PLANNING_@{pipeline().parameters.p_IPPF_RULES_VIEW} AS wp   join (SELECT  ROW_NUMBER() OVER(ORDER BY 1) AS NUMBER FROM BLUEPP.WBS_PLANNING_@{pipeline().parameters.p_IPPF_RULES_VIEW} FETCH FIRST 12 ROWS ONLY) AS T(A1)         ON T.A1=T.A1   JOIN BLUEPP.WBS_ELEMENT_MASTER_@{pipeline().parameters.p_IPPF_RULES_VIEW} we ON we.WBS_ID = wp.WBS_ID  WHERE wp.VER_NUM='001'  and we.CHRG_CTRY_CD @{pipeline().parameters.p_IPPF_RULES_COUNTRIES_BH}  and we.LVL_NUM in (1,2)) t2  ) t3 where WBS_ELEM_OC_AMT!=0 GROUP BY      t3.WBS_ID,     t3.COST_ELEM_CD,     t3.MONTH_NUM,     t3.YEAR_NUM,     t3.WBS_LVL_NUM WITH UR",
							"type": "Expression"
						}
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"dataIntegrationUnits": 2,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "ds_sourceDB2",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference",
						"parameters": {
							"p_sourceName": {
								"value": "V164S6P1.csv",
								"type": "Expression"
							},
							"p_folder": {
								"value": "@{pipeline().parameters.p_folder}",
								"type": "Expression"
							}
						}
					}
				]
			},
			{
				"name": "V164S8P2",
				"description": "CNMN_COST_ELEMENT",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "V164S6P1",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "Db2Source",
						"query": {
							"value": "SELECT COST_ELEM_CD, VAL_CAT_CD FROM CNMN.COST_ELEMENT WITH UR",
							"type": "Expression"
						}
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"dataIntegrationUnits": 2,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "ds_sourceDB2",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference",
						"parameters": {
							"p_sourceName": {
								"value": "V164S8P2.csv",
								"type": "Expression"
							},
							"p_folder": {
								"value": "@{pipeline().parameters.p_folder}",
								"type": "Expression"
							}
						}
					}
				]
			}
		],
		"parameters": {
			"p_IPPF_RULES_VIEW": {
				"type": "String"
			},
			"p_IPPF_RULES_COUNTRIES_BH": {
				"type": "String"
			},
			"p_folder": {
				"type": "String"
			}
		},
		"annotations": []
	}
}