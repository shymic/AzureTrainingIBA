{
	"name": "pl_005",
	"properties": {
		"activities": [
			{
				"name": "V161S0P2",
				"description": "V161S1",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "Db2Source",
						"query": {
							"value": "SELECT cast(AL1.CTRY_CD as char(4)) as SAP_CMPNY_CD\nFROM BMSIW.GEO_RGN_CTRY_UV AL1\nJOIN BMSIW.COUNTRY_REF_UV AL2 \n        ON AL1.CTRY_CD=AL2.COUNTRY_CD\n        AND AL1.RGN_LVL1_CD @{pipeline().parameters.p_IPPF_RULES_RGN_LVL1_CD}\n        AND AL2.STATUS='O'\nWHERE '@{pipeline().parameters.p_IPPF_RULES_INST}'<>'CDT - '||'@{pipeline().parameters.p_IPPF_RULES_GEO_NAME}'\nOR (AL1.CTRY_CD @{pipeline().parameters.p_IPPF_RULES_COUNTRIES} and '@{pipeline().parameters.p_IPPF_RULES_INST}'='CDT - '||'@{pipeline().parameters.p_IPPF_RULES_GEO_NAME}')\nfetch first 250 rows only\nWITH UR",
							"type": "Expression"
						}
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"dataIntegrationUnits": 2,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "ds_sourceDB2",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference",
						"parameters": {
							"p_fileName": "V161S0P2.csv",
							"p_folder": "LIPPFD0005_PROJECT_HEADER_LOAD_INTGRT"
						}
					}
				]
			},
			{
				"name": "V161S5P1",
				"description": "V161S2",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "V161S0P2",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "Db2Source",
						"query": {
							"value": "SELECT DISTINCT\n1 as PROJ_WBS_NUM,\ncast(CON.DESCRIPTION as char(240) for SBCS data) as PROJ_DESC,\nCON.CONTRCREATEDATE as PROJ_PLANNED_STRT_DT,\nCON.CONTRBEGINDATE as PROJ_PLANNED_END_DT,\n'' as PRFT_CNTR_CD,\n'' as COST_CNTR_CD,\n0 as APPLCNT_NUM,\n'' as APPLCNT_NM,\n'' as FUNCTL_AREA_CD,\n'' as CNTL_AREA_CD,\n'' as PROJ_PROF_CD,\n'' as PROJ_CRNCY_CD,\n'' as PROJ_TYP_CD,\n CON.COUNTRY as SAP_CMPNY_CD,\nCON.COUNTRY as BH_SAP_CMPNY_CD,\nCON.CONTRACTNUMBER as PROJ_WBS_ID,\n'BMS' as APPL_IND\n                                              \n FROM \nBMSIW.T510BUS_UV        BUS,    \nBMSIW.T510WRK_UV        WRK,                                                 \nBMSIW.T510CON_UV        CON \n \nJOIN BMSIW.COMPANY_REF_UV sc on sc.COUNTRY_CD = WRK.COUNTRY  and sc.COMPANY_CD = WRK.COMPANYCODE @{pipeline().parameters.p_IPPF_RULES_COMPANY_COND}\n\nWHERE  BUS.COUNTRY        = WRK.COUNTRY              \nAND    BUS.COMPANYCODE    = WRK.COMPANYCODE          \nAND    BUS.BUSINESSTYPE   = WRK.BUSINESSTYPE         \nAND    WRK.COUNTRY        = CON.COUNTRY              \nAND    WRK.COMPANYCODE    = CON.COMPANYCODE          \nAND    WRK.CONTRACTNUMBER = CON.CONTRACTNUMBER    \n \nAND ( substr(char(CON.CONTRENDDATE),1,7) >= substr(char(current date  - 3 YEARS),1,7)  --changed by E.S. Task 560.1\n OR    CON.CONTRACTSTATUS IN ( 'A', 'P' ) )\nAND CON.CONTRACTNUMBER<>''\n@{pipeline().parameters.p_IPPF_RULES_CONTR_STATUS}             \nAND  ( ( CON.COUNTRY    in (      SELECT cast(AL1.CTRY_CD as char(4))\nFROM BMSIW.GEO_RGN_CTRY_UV AL1\nJOIN BMSIW.COUNTRY_REF_UV AL2 \n        ON AL1.CTRY_CD=AL2.COUNTRY_CD\n        AND AL1.RGN_LVL1_CD @{pipeline().parameters.p_IPPF_RULES_RGN_LVL1_CD}\n        AND AL1.CTRY_CD not @{pipeline().parameters.p_IPPF_RULES_COUNTRIES_BH}\n        AND AL1.CTRY_CD not @{pipeline().parameters.p_IPPF_RULES_COUNTRIES_MIGR}\n        AND AL2.STATUS='O'  and AL1.CTRY_CD!='606'\nWHERE '@{pipeline().parameters.p_IPPF_RULES_INST}'<>'CDT - '||'@{pipeline().parameters.p_IPPF_RULES_GEO_NAME}'\nOR (AL1.CTRY_CD @{pipeline().parameters.p_IPPF_RULES_COUNTRIES} and '@{pipeline().parameters.p_IPPF_RULES_INST}'='CDT - '||'@{pipeline().parameters.p_IPPF_RULES_GEO_NAME}')\nfetch first 250 rows only) @{pipeline().parameters.p_IPPF_RULES_GEO}\n) or (CON.COUNTRY='606'))\n--AND    BU.BUSMEASUREDIV   in @{pipeline().parameters.p_IPPF_RULES_DIVISIONS}                                                       \nWITH UR",
							"type": "Expression"
						}
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"dataIntegrationUnits": 2,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "ds_sourceDB2",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference",
						"parameters": {
							"p_fileName": "V161S5P1.csv",
							"p_folder": "LIPPFD0005_PROJECT_HEADER_LOAD_INTGRT"
						}
					}
				]
			},
			{
				"name": "V161S5P2",
				"description": "V161S4",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "V161S5P1",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "Db2Source",
						"query": {
							"value": "SELECT distinct v.RCVCUSTCTRY as SAP_CMPNY_CD1,v.contractnumber as PROJ_WBS_ID\nFROM BMSIW.t510wrk_UV           V \nJOIN  BMSIW.COUNTRY_REF_UV AL2 \nON v.COUNTRY=AL2.COUNTRY_CD\nJOIN  BMSIW.COUNTRY_REF_UV AL3\nON v.RCVCUSTCTRY=AL3.COUNTRY_CD\nJOIN BMSIW.GEO_RGN_CTRY_UV AL4\nON AL4.CTRY_CD=AL2.COUNTRY_CD\nJOIN BMSIW.GEO_RGN_CTRY_UV AL5\nON AL5.CTRY_CD=AL3.COUNTRY_CD\n   where v.country <> v.RCVCUSTCTRY \n   and v.country='606'\n and v.contractnumber <>''  \nWITH UR",
							"type": "Expression"
						}
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"dataIntegrationUnits": 2,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "ds_sourceDB2",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference",
						"parameters": {
							"p_fileName": "V161S5P2.csv",
							"p_folder": "LIPPFD0005_PROJECT_HEADER_LOAD_INTGRT"
						}
					}
				]
			},
			{
				"name": "V161S8P1",
				"description": "V161S7",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "V161S5P2",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "Db2Source",
						"query": {
							"value": "SELECT DISTINCT \n1 as PROJ_WBS_NUM,\nco.ACCTGRP_DESC as PROJ_DESC,\nCO.CNTRCT_BEGIN_DATE as PROJ_PLANNED_STRT_DT,\nCO.CNTRCT_END_DATE as PROJ_PLANNED_END_DT,\n'' as PRFT_CNTR_CD,\n'' as COST_CNTR_CD,\n0 as APPLCNT_NUM,\n'' as APPLCNT_NM,\n'' as FUNCTL_AREA_CD,\n'' as CNTL_AREA_CD,\n'' as PROJ_PROF_CD,\n'' as PROJ_CRNCY_CD,\n'' as PROJ_TYP_CD,\nCO.OWNING_COUNTRY_CD  as SAP_CMPNY_CD,\nCO.OWNING_COUNTRY_CD  as BH_SAP_CMPNY_CD,\nCO.ACCTGRP_ID as PROJ_WBS_ID,\n'BMS' as APPL_IND\n\nfrom\nbmsiw.account_uv wrk\nINNER JOIN BMSIW.ACCOUNT_GROUP_UV CO\n    ON wrk.ACCTGRP_ID = CO.ACCTGRP_ID\n   AND wrk.CONTROL_GROUP_CD = CO.CONTROL_GROUP_CD\nINNER JOIN BMSIW.T510BUS_UV BUS\n    ON BUS.COUNTRY        = WRK.OWNING_COUNTRY_CD              \n   AND BUS.COMPANYCODE    = WRK.OWNING_COMPANY_CD          \n   AND BUS.BUSINESSTYPE   = WRK.BUS_TYP_CD\nLEFT join BMSIW.T510CON_UV co1\n    on co.ACCTGRP_ID = co1.contractnumber\n    and wrk.OWNING_COUNTRY_CD = co1.COUNTRY\n    and co.OWNING_COMPANY_CD = co1.COMPANYCODE\n\nJOIN BMSIW.COMPANY_REF_UV sc on sc.COUNTRY_CD = WRK.OWNING_COUNTRY_CD   and sc.COMPANY_CD = WRK.OWNING_COMPANY_CD @{pipeline().parameters.p_IPPF_RULES_COMPANY_COND}\n\nWHERE co1.CONTRACTNUMBER IS NULL  and bus.LOBID in ('SO','ITS','MAI','ISS','EBH','CLD','CLO')\nand co.ACCTGRP_ID<>''\nand wrk.status in ('O')\nand bus.BUSMEASUREDIV <> '16'\nand wrk.ACCT_TYP_CD = 'C' \nand wrk.OFFERING_COMP_CD <> ''\n\nAND wrk.OWNING_COUNTRY_CD in (SELECT cast(AL1.CTRY_CD as char(4))\nFROM BMSIW.GEO_RGN_CTRY_UV AL1\nJOIN BMSIW.COUNTRY_REF_UV AL2 \n        ON AL1.CTRY_CD=AL2.COUNTRY_CD\n        AND AL1.RGN_LVL1_CD @{pipeline().parameters.p_IPPF_RULES_RGN_LVL1_CD}\n        AND AL1.CTRY_CD not @{pipeline().parameters.p_IPPF_RULES_COUNTRIES_BH}\n        AND AL1.CTRY_CD not @{pipeline().parameters.p_IPPF_RULES_COUNTRIES_MIGR}\n        AND AL2.STATUS='O' \nWHERE '@{pipeline().parameters.p_IPPF_RULES_INST}'<>'CDT - '||'@{pipeline().parameters.p_IPPF_RULES_GEO_NAME}'\nOR (AL1.CTRY_CD @{pipeline().parameters.p_IPPF_RULES_COUNTRIES} and '@{pipeline().parameters.p_IPPF_RULES_INST}'='CDT - '||'@{pipeline().parameters.p_IPPF_RULES_GEO_NAME}')\nfetch first 250 rows only)    \n     \nwith ur",
							"type": "Expression"
						}
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"dataIntegrationUnits": 2,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "ds_sourceDB2",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference",
						"parameters": {
							"p_fileName": "V161S8P1.csv",
							"p_folder": "LIPPFD0005_PROJECT_HEADER_LOAD_INTGRT"
						}
					}
				]
			},
			{
				"name": "V161S10P1",
				"description": "V161S11",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "V161S8P1",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "Db2Source",
						"query": {
							"value": "SELECT\n t1.WBS_NUM as PROJ_WBS_NUM\n ,t1.SHORT_DESC as PROJ_NM\n ,t1.PLAN_STRT_DT as PROJ_PLANNED_STRT_DT\n ,t1.PLAN_CMPLN_DT as PROJ_PLANNED_END_DT\n ,case when t1.PRFT_CNTR_CD ='' then '-1' else t1.PRFT_CNTR_CD end as PRFT_CNTR_CD\n ,' ' as COST_CNTR_CD\n ,t1.APPL_NUM as APPL_NUM\n ,t1.APPL_NM as APPL_NM\n ,t1.FUNCTL_AREA_CD as FUNCTL_AREA_CD\n ,t1.CNTL_PROJ_CD as CNTL_AREA_CD\n ,t1.PROJ_PROF_CD as PROJ_PROF_CD\n ,t1.PROJ_CRNCY_CD as PROJ_CRNCY_CD\n ,t2.PROJ_TYP_CD as PROJ_TYP_CD\n ,t1.SAP_CMPNY_CD as CMPNY_CD\n ,t1.CHRG_CTRY_CD as CHRG_CTRY_CD\n ,t1.WBS_ID as PROJ_ID\n ,'BH' as APPL_IND \nFROM BLUEPP.WBS_PROJ_HEADER_@{pipeline().parameters.p_IPPF_RULES_VIEW} t1\ninner join bmsiw.COMPANY_REF_@{pipeline().parameters.p_IPPF_RULES_VIEW} sc on sc.sap_company_cd = t1.SAP_CMPNY_CD @{pipeline().parameters.p_IPPF_RULES_COMPANY_COND}\nLEFT JOIN BLUEPP.WBS_ELEMENT_MASTER_@{pipeline().parameters.p_IPPF_RULES_VIEW} t2 ON\nt1.WBS_ID = t2.WBS_ID\nwhere cast(t1.CHRG_CTRY_CD as char(3)) @{pipeline().parameters.p_IPPF_RULES_COUNTRIES_BH}",
							"type": "Expression"
						}
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"dataIntegrationUnits": 2,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "ds_sourceDB2",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference",
						"parameters": {
							"p_fileName": "V161S10P1.csv",
							"p_folder": "LIPPFD0005_PROJECT_HEADER_LOAD_INTGRT"
						}
					}
				]
			},
			{
				"name": "Transformation",
				"type": "ExecuteDataFlow",
				"dependsOn": [
					{
						"activity": "V161S10P1",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"dataflow": {
						"referenceName": "df_005",
						"type": "DataFlowReference",
						"parameters": {
							"p_IPPF_RULES_SCHEME": {
								"value": "'@{pipeline().parameters.p_IPPF_RULES_SCHEME}'",
								"type": "Expression"
							}
						},
						"datasetParameters": {
							"V161S0P2": {
								"p_folder": "LIPPFD0005_PROJECT_HEADER_LOAD_INTGRT",
								"p_fileName": "V161S0P2.csv"
							},
							"V161S5P1": {
								"p_folder": "LIPPFD0005_PROJECT_HEADER_LOAD_INTGRT",
								"p_fileName": "V161S5P1.csv"
							},
							"V161S5P2": {
								"p_folder": "LIPPFD0005_PROJECT_HEADER_LOAD_INTGRT",
								"p_fileName": "V161S5P2.csv"
							},
							"V161S8P1": {
								"p_folder": "LIPPFD0005_PROJECT_HEADER_LOAD_INTGRT",
								"p_fileName": "V161S8P1.csv"
							},
							"V161S10P1": {
								"p_folder": "LIPPFD0005_PROJECT_HEADER_LOAD_INTGRT",
								"p_fileName": "V161S10P1.csv"
							},
							"V161S6": {
								"p_schema": {
									"value": "@{pipeline().parameters.p_IPPF_RULES_SCHEME}",
									"type": "Expression"
								},
								"p_table": "PROJECT_HEADER_LOAD"
							}
						}
					},
					"integrationRuntime": {
						"referenceName": "ir-azure-DataFlow",
						"type": "IntegrationRuntimeReference"
					},
					"traceLevel": "None"
				}
			}
		],
		"parameters": {
			"p_IPPF_RULES_COMPANY_COND": {
				"type": "String"
			},
			"p_IPPF_RULES_VIEW": {
				"type": "String"
			},
			"p_IPPF_RULES_CONTR_STATUS": {
				"type": "String"
			},
			"p_IPPF_RULES_DIVISIONS": {
				"type": "String"
			},
			"p_IPPF_RULES_SCHEME": {
				"type": "String"
			},
			"p_IPPF_RULES_RGN_LVL1_CD": {
				"type": "String"
			},
			"p_IPPF_RULES_GEO": {
				"type": "String"
			},
			"p_IPPF_RULES_COUNTRIES_MIGR": {
				"type": "String"
			},
			"p_IPPF_RULES_COUNTRIES_BH": {
				"type": "String"
			},
			"p_IPPF_RULES_GEO_NAME": {
				"type": "String"
			},
			"p_IPPF_RULES_INST": {
				"type": "String"
			},
			"p_IPPF_RULES_COUNTRIES": {
				"type": "String"
			}
		},
		"annotations": []
	}
}