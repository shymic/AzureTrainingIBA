{
	"name": "pl_005",
	"properties": {
		"activities": [
			{
				"name": "V161S1",
				"description": "V161S1",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "Db2Source",
						"query": {
							"value": "SELECT\n    CAST(AL1.CTRY_CD AS CHAR(4)) AS SAP_CMPNY_CD\nFROM\n    BMSIW.GEO_RGN_CTRY_UV AL1\nJOIN\n    BMSIW.COUNTRY_REF_UV AL2\nON\n    AL1.CTRY_CD=AL2.COUNTRY_CD\nAND AL1.RGN_LVL1_CD @{pipeline().parameters.p_IPPF_RULES_RGN_LVL1_CD}\nAND AL2.STATUS='O'\nWHERE\n    '@{pipeline().parameters.p_IPPF_RULES_INST}'<>'CDT - ' ||\n    '@{pipeline().parameters.p_IPPF_RULES_GEO_NAME}'\nOR  (\n        AL1.CTRY_CD @{pipeline().parameters.p_IPPF_RULES_COUNTRIES}\n    AND '@{pipeline().parameters.p_IPPF_RULES_INST}'='CDT - ' ||\n        '@{pipeline().parameters.p_IPPF_RULES_GEO_NAME}')\nFETCH\n    FIRST 250 rows only WITH UR",
							"type": "Expression"
						}
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"dataIntegrationUnits": 2,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "ds_sourceDB2",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference",
						"parameters": {
							"p_fileName": {
								"value": "V161S1.csv",
								"type": "Expression"
							},
							"p_folder": {
								"value": "LIPPFD005",
								"type": "Expression"
							}
						}
					}
				]
			},
			{
				"name": "V161S11",
				"description": "V161S11",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "V161S1",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "Db2Source",
						"query": {
							"value": "SELECT\n    t1.WBS_NUM       AS PROJ_WBS_NUM ,\n    t1.SHORT_DESC    AS PROJ_NM ,\n    t1.PLAN_STRT_DT  AS PROJ_PLANNED_STRT_DT ,\n    t1.PLAN_CMPLN_DT AS PROJ_PLANNED_END_DT ,\n    '-1'               AS PRFT_CNTR_CD ,\n    ' '               AS COST_CNTR_CD ,\n    t1.APPL_NUM       AS APPL_NUM ,\n    t1.APPL_NM        AS APPL_NM ,\n    t1.FUNCTL_AREA_CD AS FUNCTL_AREA_CD ,\n    t1.CNTL_PROJ_CD   AS CNTL_AREA_CD ,\n    t1.PROJ_PROF_CD   AS PROJ_PROF_CD ,\n    t1.PROJ_CRNCY_CD  AS PROJ_CRNCY_CD ,\n    t2.PROJ_TYP_CD    AS PROJ_TYP_CD ,\n    t1.SAP_CMPNY_CD   AS CMPNY_CD ,\n    t1.CHRG_CTRY_CD   AS CHRG_CTRY_CD ,\n    t1.WBS_ID         AS PROJ_ID ,\n    'BH'              AS APPL_IND\nFROM\n    BLUEPP.WBS_PROJ_HEADER_@{pipeline().parameters.p_IPPF_RULES_VIEW} t1\nINNER JOIN\n    bmsiw.COMPANY_REF_@{pipeline().parameters.p_IPPF_RULES_VIEW} sc\nON\n    sc.sap_company_cd = t1.SAP_CMPNY_CD @{pipeline().parameters.p_IPPF_RULES_COMPANY_COND}\nLEFT JOIN\n    BLUEPP.WBS_ELEMENT_MASTER_@{pipeline().parameters.p_IPPF_RULES_VIEW} t2\nON\n    t1.WBS_ID = t2.WBS_ID\nWHERE\n    CAST(t1.CHRG_CTRY_CD AS CHAR(3)) @{pipeline().parameters.p_IPPF_RULES_COUNTRIES_BH}",
							"type": "Expression"
						}
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"dataIntegrationUnits": 2,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "ds_sourceDB2",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference",
						"parameters": {
							"p_fileName": {
								"value": "V161S11.csv",
								"type": "Expression"
							},
							"p_folder": {
								"value": "LIPPFD005",
								"type": "Expression"
							}
						}
					}
				]
			},
			{
				"name": "V161S2",
				"description": "V161S2",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "V161S11",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "Db2Source",
						"query": {
							"value": "SELECT DISTINCT\n    1                                                AS PROJ_WBS_NUM,\n    CAST(CON.DESCRIPTION AS CHAR(240) ) AS PROJ_DESC,\n    CON.CONTRCREATEDATE                              AS PROJ_PLANNED_STRT_DT,\n    CON.CONTRBEGINDATE                               AS PROJ_PLANNED_END_DT,\n    ''                                               AS PRFT_CNTR_CD,\n    ''                                               AS COST_CNTR_CD,\n    0                                                AS APPLCNT_NUM,\n    ''                                               AS APPLCNT_NM,\n    ''                                               AS FUNCTL_AREA_CD,\n    ''                                               AS CNTL_AREA_CD,\n    ''                                               AS PROJ_PROF_CD,\n    ''                                               AS PROJ_CRNCY_CD,\n    ''                                               AS PROJ_TYP_CD,\n    CON.COUNTRY                                      AS SAP_CMPNY_CD,\n    CON.COUNTRY                                      AS BH_SAP_CMPNY_CD,\n    CON.CONTRACTNUMBER                               AS PROJ_WBS_ID,\n    'BMS'                                            AS APPL_IND\nFROM\n    /*BMSIW.T510BUS_UV BUS,\n    BMSIW.T510WRK_UV WRK,*/\n    BMSIW.T510CON_UV CON",
							"type": "Expression"
						}
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"dataIntegrationUnits": 2,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "ds_sourceDB2",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference",
						"parameters": {
							"p_fileName": {
								"value": "V161S2.csv",
								"type": "Expression"
							},
							"p_folder": {
								"value": "LIPPFD005",
								"type": "Expression"
							}
						}
					}
				]
			},
			{
				"name": "V161S4",
				"description": "V161S4",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "V161S2",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "Db2Source",
						"query": {
							"value": "SELECT distinct v.RCVCUSTCTRY as SAP_CMPNY_CD1,v.contractnumber as PROJ_WBS_ID FROM BMSIW.t510wrk_UV           V  JOIN  BMSIW.COUNTRY_REF_UV AL2  ON v.COUNTRY=AL2.COUNTRY_CD JOIN  BMSIW.COUNTRY_REF_UV AL3 ON v.RCVCUSTCTRY=AL3.COUNTRY_CD JOIN BMSIW.GEO_RGN_CTRY_UV AL4 ON AL4.CTRY_CD=AL2.COUNTRY_CD JOIN BMSIW.GEO_RGN_CTRY_UV AL5 ON AL5.CTRY_CD=AL3.COUNTRY_CD    where v.country <> v.RCVCUSTCTRY     and v.country='606'  and v.contractnumber <>''   WITH UR",
							"type": "Expression"
						}
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"dataIntegrationUnits": 2,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "ds_sourceDB2",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference",
						"parameters": {
							"p_fileName": {
								"value": "V161S4.csv",
								"type": "Expression"
							},
							"p_folder": {
								"value": "LIPPFD005",
								"type": "Expression"
							}
						}
					}
				]
			},
			{
				"name": "V161S7",
				"description": "V161S7",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "V161S4",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "Db2Source",
						"query": {
							"value": "SELECT DISTINCT\n    1                    AS PROJ_WBS_NUM,\n    co.ACCTGRP_DESC      AS PROJ_DESC,\n    CO.CNTRCT_BEGIN_DATE AS PROJ_PLANNED_STRT_DT,\n    CO.CNTRCT_END_DATE   AS PROJ_PLANNED_END_DT,\n    ''                   AS PRFT_CNTR_CD,\n    ''                   AS COST_CNTR_CD,\n    0                    AS APPLCNT_NUM,\n    ''                   AS APPLCNT_NM,\n    ''                   AS FUNCTL_AREA_CD,\n    ''                   AS CNTL_AREA_CD,\n    ''                   AS PROJ_PROF_CD,\n    ''                   AS PROJ_CRNCY_CD,\n    ''                   AS PROJ_TYP_CD,\n    CO.OWNING_COUNTRY_CD AS SAP_CMPNY_CD,\n    CO.OWNING_COUNTRY_CD AS BH_SAP_CMPNY_CD,\n    CO.ACCTGRP_ID        AS PROJ_WBS_ID,\n    'BMS'                AS APPL_IND\nFROM\n    bmsiw.account_uv wrk\nINNER JOIN\n    BMSIW.ACCOUNT_GROUP_UV CO\nON\n    wrk.ACCTGRP_ID = CO.ACCTGRP_ID\nAND wrk.CONTROL_GROUP_CD = CO.CONTROL_GROUP_CD",
							"type": "Expression"
						}
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"dataIntegrationUnits": 2,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "ds_sourceDB2",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference",
						"parameters": {
							"p_fileName": {
								"value": "V161S7.csv",
								"type": "Expression"
							},
							"p_folder": {
								"value": "LIPPFD005",
								"type": "Expression"
							}
						}
					}
				]
			},
			{
				"name": "Transform",
				"type": "ExecuteDataFlow",
				"dependsOn": [
					{
						"activity": "V161S7",
						"dependencyConditions": [
							"Completed"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"dataflow": {
						"referenceName": "df_005",
						"type": "DataFlowReference",
						"datasetParameters": {
							"V161S0P2": {
								"p_fileName": "V161S1.csv",
								"p_folder": "LIPPFD005"
							},
							"V161S5P1": {
								"p_fileName": "V161S11.csv",
								"p_folder": "LIPPFD005"
							},
							"V161S5P2": {
								"p_fileName": "V161S2.csv",
								"p_folder": "LIPPFD005"
							},
							"V161S8P1": {
								"p_fileName": "V161S4.csv",
								"p_folder": "LIPPFD005"
							},
							"V161S10P1": {
								"p_fileName": "V161S7.csv",
								"p_folder": "LIPPFD005"
							},
							"V161S6": {
								"p_schema": "dbo",
								"p_table": "PROJECT_HEADER_LOAD"
							}
						}
					},
					"compute": {
						"coreCount": 8,
						"computeType": "General"
					},
					"traceLevel": "None",
					"cacheSinks": {
						"firstRowOnly": true
					}
				}
			}
		],
		"parameters": {
			"p_IPPF_RULES_COMPANY_COND": {
				"type": "String",
				"defaultValue": "and sc.COMPANY_CD like ('NEWIS%')"
			},
			"p_IPPF_RULES_VIEW": {
				"type": "String",
				"defaultValue": "UV"
			},
			"p_IPPF_RULES_CONTR_STATUS": {
				"type": "String",
				"defaultValue": "--AND      CO.CONTRACTSTATUS    <> 'N' "
			},
			"p_IPPF_RULES_DIVISIONS": {
				"type": "String",
				"defaultValue": "IN ('Z4', 'Z6', 'K5', 'Z8', '72', '7G', '7H', 'Z1', '7D', 'J9', '80', 'K4', 'K8', 'K9', 'T8', 'H5', '7Y', '20', 'G2', '48', '46', '30', '36', '2P', '8F', '7F', '2R', '1C', '4E', '70', '51', '66')"
			},
			"p_IPPF_RULES_GEO": {
				"type": "String",
				"defaultValue": "--AND    CO.GEO_SRC_CD = 'NA'    AND    WR.GEO_SRC_CD = 'NA'"
			},
			"p_IPPF_RULES_RGN_LVL1_CD": {
				"type": "String",
				"defaultValue": "in (cast('EA' as char(2)),cast('EP' as char(2)),cast('EM' as char(2))) "
			},
			"p_IPPF_RULES_COUNTRIES_MIGR": {
				"type": "String",
				"defaultValue": "as char(3)),cast('702' as char(3)), cast('742' as char(3)),cast('788' as char(3)), cast('806' as char(3)), cast('812' as char(3)),cast('622' as char(3)), cast('846' as char(3)))"
			},
			"p_IPPF_RULES_COUNTRIES_BH": {
				"type": "String",
				"defaultValue": "in (cast('358' as char(3)), cast('622' as char(3)), cast('724' as char(3)), cast('767' as char(3)), cast('854' as char(3)), cast('618' as char(3)), cast('848' as char(3)), cast('809' as char(3)), cast('913' as char(3)), cast('706' as char(3)),cast('623' as char(3)), cast('624' as char(3)), cast('653' as char(3)), cast('678' as char(3)),cast('702' as char(3)), cast('742' as char(3)),cast('788' as char(3)), cast('806' as char(3)), cast('812' as char(3)),cast('846' as char(3)))"
			},
			"p_IPPF_RULES_GEO_NAME": {
				"type": "String",
				"defaultValue": "EU"
			},
			"p_IPPF_RULES_INST": {
				"type": "String",
				"defaultValue": "CDT - EU"
			},
			"p_IPPF_RULES_COUNTRIES": {
				"type": "String",
				"defaultValue": "in (cast ('602' as char(3)), cast('618' as char(3)), cast('668' as char(3)), cast('678' as char(3)), cast('706' as char(3)), cast('726' as char(3)), cast('740' as char(3)), cast('755' as char(3)), cast('758' as char(3)), cast('764' as char(3)), cast('788' as char(3)), cast('820' as char(3)), cast('808' as char(3)), cast('822' as char(3)), cast('821' as char(3)), cast('832' as char(3)), cast('826' as char(3)), cast('846' as char(3)), cast('848' as char(3)), cast('864' as char(3)), cast('866' as char(3)), cast('862' as char(3)), cast('889' as char(3)), cast('865' as char(3)), cast('724' as char(3)), cast('702' as char(3)), cast('806' as char(3)), cast('675' as char(3)), cast('622' as char(3)), cast ('624' as char(3)))"
			}
		},
		"folder": {
			"name": "obachilo"
		},
		"annotations": []
	}
}