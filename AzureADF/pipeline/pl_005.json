{
	"name": "pipeline1",
	"properties": {
		"activities": [
			{
				"name": "V161S1",
				"description": "V161S1",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "Db2Source",
						"query": {
							"value": "SELECT cast(AL1.CTRY_CD as char(4)) as SAP_CMPNY_CD FROM BMSIW.GEO_RGN_CTRY_UV AL1 JOIN BMSIW.COUNTRY_REF_UV AL2          ON AL1.CTRY_CD=AL2.COUNTRY_CD         AND AL1.RGN_LVL1_CD @{pipeline().parameters.p_IPPF_RULES_RGN_LVL1_CD}         AND AL2.STATUS='O' WHERE '@{pipeline().parameters.p_IPPF_RULES_INST}'<>'CDT - '  '@{pipeline().parameters.p_IPPF_RULES_GEO_NAME}' OR (AL1.CTRY_CD @{pipeline().parameters.p_IPPF_RULES_COUNTRIES} and '@{pipeline().parameters.p_IPPF_RULES_INST}'='CDT - '  '@{pipeline().parameters.p_IPPF_RULES_GEO_NAME}') fetch first 250 rows only WITH UR",
							"type": "Expression"
						}
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"dataIntegrationUnits": 2,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "ds_sourceDB2",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference",
						"parameters": {
							"p_fileName": {
								"value": "V161S1.csv",
								"type": "Expression"
							},
							"p_folder": {
								"value": "LIPPFD005",
								"type": "Expression"
							}
						}
					}
				]
			},
			{
				"name": "V161S11",
				"description": "V161S11",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "V161S1",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "Db2Source",
						"query": {
							"value": "SELECT  t1.WBS_NUM as PROJ_WBS_NUM  ,t1.SHORT_DESC as PROJ_NM  ,t1.PLAN_STRT_DT as PROJ_PLANNED_STRT_DT  ,t1.PLAN_CMPLN_DT as PROJ_PLANNED_END_DT  ,case when t1.PRFT_CNTR_CD ='' then '-1' else t1.PRFT_CNTR_CD end as PRFT_CNTR_CD  ,' ' as COST_CNTR_CD  ,t1.APPL_NUM as APPL_NUM  ,t1.APPL_NM as APPL_NM  ,t1.FUNCTL_AREA_CD as FUNCTL_AREA_CD  ,t1.CNTL_PROJ_CD as CNTL_AREA_CD  ,t1.PROJ_PROF_CD as PROJ_PROF_CD  ,t1.PROJ_CRNCY_CD as PROJ_CRNCY_CD  ,t2.PROJ_TYP_CD as PROJ_TYP_CD  ,t1.SAP_CMPNY_CD as CMPNY_CD  ,t1.CHRG_CTRY_CD as CHRG_CTRY_CD  ,t1.WBS_ID as PROJ_ID  ,'BH' as APPL_IND  FROM BLUEPP.WBS_PROJ_HEADER_@{pipeline().parameters.p_IPPF_RULES_VIEW} t1 inner join bmsiw.COMPANY_REF_@{pipeline().parameters.p_IPPF_RULES_VIEW} sc on sc.sap_company_cd = t1.SAP_CMPNY_CD @{pipeline().parameters.p_IPPF_RULES_COMPANY_COND} LEFT JOIN BLUEPP.WBS_ELEMENT_MASTER_@{pipeline().parameters.p_IPPF_RULES_VIEW} t2 ON t1.WBS_ID = t2.WBS_ID where cast(t1.CHRG_CTRY_CD as char(3)) @{pipeline().parameters.p_IPPF_RULES_COUNTRIES_BH}",
							"type": "Expression"
						}
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"dataIntegrationUnits": 2,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "ds_sourceDB2",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference",
						"parameters": {
							"p_fileName": {
								"value": "V161S11.csv",
								"type": "Expression"
							},
							"p_folder": {
								"value": "LIPPFD005",
								"type": "Expression"
							}
						}
					}
				]
			},
			{
				"name": "V161S2",
				"description": "V161S2",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "V161S11",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "Db2Source",
						"query": {
							"value": "SELECT DISTINCT 1 as PROJ_WBS_NUM, cast(CON.DESCRIPTION as char(240) for SBCS data) as PROJ_DESC, CON.CONTRCREATEDATE as PROJ_PLANNED_STRT_DT, CON.CONTRBEGINDATE as PROJ_PLANNED_END_DT, '' as PRFT_CNTR_CD, '' as COST_CNTR_CD, 0 as APPLCNT_NUM, '' as APPLCNT_NM, '' as FUNCTL_AREA_CD, '' as CNTL_AREA_CD, '' as PROJ_PROF_CD, '' as PROJ_CRNCY_CD, '' as PROJ_TYP_CD,  CON.COUNTRY as SAP_CMPNY_CD, CON.COUNTRY as BH_SAP_CMPNY_CD, CON.CONTRACTNUMBER as PROJ_WBS_ID, 'BMS' as APPL_IND                                                 FROM  BMSIW.T510BUS_UV        BUS,     BMSIW.T510WRK_UV        WRK,                                                  BMSIW.T510CON_UV        CON    JOIN BMSIW.COMPANY_REF_UV sc on sc.COUNTRY_CD = WRK.COUNTRY  and sc.COMPANY_CD = WRK.COMPANYCODE @{pipeline().parameters.p_IPPF_RULES_COMPANY_COND}  WHERE  BUS.COUNTRY        = WRK.COUNTRY               AND    BUS.COMPANYCODE    = WRK.COMPANYCODE           AND    BUS.BUSINESSTYPE   = WRK.BUSINESSTYPE          AND    WRK.COUNTRY        = CON.COUNTRY               AND    WRK.COMPANYCODE    = CON.COMPANYCODE           AND    WRK.CONTRACTNUMBER = CON.CONTRACTNUMBER       AND ( substr(char(CON.CONTRENDDATE),1,7) >= substr(char(current date  - 3 YEARS),1,7)  --changed by E.S. Task 560.1  OR    CON.CONTRACTSTATUS IN ( 'A', 'P' ) ) AND CON.CONTRACTNUMBER<>'' @{pipeline().parameters.p_IPPF_RULES_CONTR_STATUS}              AND  ( ( CON.COUNTRY    in (      SELECT cast(AL1.CTRY_CD as char(4)) FROM BMSIW.GEO_RGN_CTRY_UV AL1 JOIN BMSIW.COUNTRY_REF_UV AL2          ON AL1.CTRY_CD=AL2.COUNTRY_CD         AND AL1.RGN_LVL1_CD @{pipeline().parameters.p_IPPF_RULES_RGN_LVL1_CD}         AND AL1.CTRY_CD not @{pipeline().parameters.p_IPPF_RULES_COUNTRIES_BH}         AND AL1.CTRY_CD not @{pipeline().parameters.p_IPPF_RULES_COUNTRIES_MIGR}         AND AL2.STATUS='O'  and AL1.CTRY_CD!='606' WHERE '@{pipeline().parameters.p_IPPF_RULES_INST}'<>'CDT - '  '@{pipeline().parameters.p_IPPF_RULES_GEO_NAME}' OR (AL1.CTRY_CD @{pipeline().parameters.p_IPPF_RULES_COUNTRIES} and '@{pipeline().parameters.p_IPPF_RULES_INST}'='CDT - '  '@{pipeline().parameters.p_IPPF_RULES_GEO_NAME}') fetch first 250 rows only) @{pipeline().parameters.p_IPPF_RULES_GEO} ) or (CON.COUNTRY='606')) --AND    BU.BUSMEASUREDIV   in @{pipeline().parameters.p_IPPF_RULES_DIVISIONS}                                                        WITH UR",
							"type": "Expression"
						}
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"dataIntegrationUnits": 2,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "ds_sourceDB2",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference",
						"parameters": {
							"p_fileName": {
								"value": "V161S2.csv",
								"type": "Expression"
							},
							"p_folder": {
								"value": "LIPPFD005",
								"type": "Expression"
							}
						}
					}
				]
			},
			{
				"name": "V161S4",
				"description": "V161S4",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "V161S2",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "Db2Source",
						"query": {
							"value": "SELECT distinct v.RCVCUSTCTRY as SAP_CMPNY_CD1,v.contractnumber as PROJ_WBS_ID FROM BMSIW.t510wrk_UV           V  JOIN  BMSIW.COUNTRY_REF_UV AL2  ON v.COUNTRY=AL2.COUNTRY_CD JOIN  BMSIW.COUNTRY_REF_UV AL3 ON v.RCVCUSTCTRY=AL3.COUNTRY_CD JOIN BMSIW.GEO_RGN_CTRY_UV AL4 ON AL4.CTRY_CD=AL2.COUNTRY_CD JOIN BMSIW.GEO_RGN_CTRY_UV AL5 ON AL5.CTRY_CD=AL3.COUNTRY_CD    where v.country <> v.RCVCUSTCTRY     and v.country='606'  and v.contractnumber <>''   WITH UR",
							"type": "Expression"
						}
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"dataIntegrationUnits": 2,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "ds_sourceDB2",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference",
						"parameters": {
							"p_fileName": {
								"value": "V161S4.csv",
								"type": "Expression"
							},
							"p_folder": {
								"value": "LIPPFD005",
								"type": "Expression"
							}
						}
					}
				]
			},
			{
				"name": "V161S7",
				"description": "V161S7",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "V161S4",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "Db2Source",
						"query": {
							"value": "SELECT DISTINCT  1 as PROJ_WBS_NUM, co.ACCTGRP_DESC as PROJ_DESC, CO.CNTRCT_BEGIN_DATE as PROJ_PLANNED_STRT_DT, CO.CNTRCT_END_DATE as PROJ_PLANNED_END_DT, '' as PRFT_CNTR_CD, '' as COST_CNTR_CD, 0 as APPLCNT_NUM, '' as APPLCNT_NM, '' as FUNCTL_AREA_CD, '' as CNTL_AREA_CD, '' as PROJ_PROF_CD, '' as PROJ_CRNCY_CD, '' as PROJ_TYP_CD, CO.OWNING_COUNTRY_CD  as SAP_CMPNY_CD, CO.OWNING_COUNTRY_CD  as BH_SAP_CMPNY_CD, CO.ACCTGRP_ID as PROJ_WBS_ID, 'BMS' as APPL_IND  from bmsiw.account_uv wrk INNER JOIN BMSIW.ACCOUNT_GROUP_UV CO     ON wrk.ACCTGRP_ID = CO.ACCTGRP_ID    AND wrk.CONTROL_GROUP_CD = CO.CONTROL_GROUP_CD INNER JOIN BMSIW.T510BUS_UV BUS     ON BUS.COUNTRY        = WRK.OWNING_COUNTRY_CD                  AND BUS.COMPANYCODE    = WRK.OWNING_COMPANY_CD              AND BUS.BUSINESSTYPE   = WRK.BUS_TYP_CD LEFT join BMSIW.T510CON_UV co1     on co.ACCTGRP_ID = co1.contractnumber     and wrk.OWNING_COUNTRY_CD = co1.COUNTRY     and co.OWNING_COMPANY_CD = co1.COMPANYCODE  JOIN BMSIW.COMPANY_REF_UV sc on sc.COUNTRY_CD = WRK.OWNING_COUNTRY_CD   and sc.COMPANY_CD = WRK.OWNING_COMPANY_CD @{pipeline().parameters.p_IPPF_RULES_COMPANY_COND}  WHERE co1.CONTRACTNUMBER IS NULL  and bus.LOBID in ('SO','ITS','MAI','ISS','EBH','CLD','CLO') and co.ACCTGRP_ID<>'' and wrk.status in ('O') and bus.BUSMEASUREDIV <> '16' and wrk.ACCT_TYP_CD = 'C'  and wrk.OFFERING_COMP_CD <> ''  AND wrk.OWNING_COUNTRY_CD in (SELECT cast(AL1.CTRY_CD as char(4)) FROM BMSIW.GEO_RGN_CTRY_UV AL1 JOIN BMSIW.COUNTRY_REF_UV AL2          ON AL1.CTRY_CD=AL2.COUNTRY_CD         AND AL1.RGN_LVL1_CD @{pipeline().parameters.p_IPPF_RULES_RGN_LVL1_CD}         AND AL1.CTRY_CD not @{pipeline().parameters.p_IPPF_RULES_COUNTRIES_BH}         AND AL1.CTRY_CD not @{pipeline().parameters.p_IPPF_RULES_COUNTRIES_MIGR}         AND AL2.STATUS='O'  WHERE '@{pipeline().parameters.p_IPPF_RULES_INST}'<>'CDT - '  '@{pipeline().parameters.p_IPPF_RULES_GEO_NAME}' OR (AL1.CTRY_CD @{pipeline().parameters.p_IPPF_RULES_COUNTRIES} and '@{pipeline().parameters.p_IPPF_RULES_INST}'='CDT - '  '@{pipeline().parameters.p_IPPF_RULES_GEO_NAME}') fetch first 250 rows only)           with ur",
							"type": "Expression"
						}
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"dataIntegrationUnits": 2,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "ds_sourceDB2",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference",
						"parameters": {
							"p_fileName": {
								"value": "V161S7.csv",
								"type": "Expression"
							},
							"p_folder": {
								"value": "LIPPFD005",
								"type": "Expression"
							}
						}
					}
				]
			}
		],
		"parameters": {
			"p_IPPF_RULES_COMPANY_COND": {
				"type": "String"
			},
			"p_IPPF_RULES_VIEW": {
				"type": "String"
			},
			"p_IPPF_RULES_CONTR_STATUS": {
				"type": "String"
			},
			"p_IPPF_RULES_DIVISIONS": {
				"type": "String"
			},
			"p_IPPF_RULES_GEO": {
				"type": "String"
			},
			"p_IPPF_RULES_RGN_LVL1_CD": {
				"type": "String"
			},
			"p_IPPF_RULES_COUNTRIES_MIGR": {
				"type": "String"
			},
			"p_IPPF_RULES_COUNTRIES_BH": {
				"type": "String"
			},
			"p_IPPF_RULES_GEO_NAME": {
				"type": "String"
			},
			"p_IPPF_RULES_INST": {
				"type": "String"
			},
			"p_folder": {
				"type": "String"
			},
			"p_IPPF_RULES_COUNTRIES": {
				"type": "String"
			}
		},
		"annotations": []
	}
}