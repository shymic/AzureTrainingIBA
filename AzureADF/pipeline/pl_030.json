{
	"name": "pl_030",
	"properties": {
		"activities": [
			{
				"name": "V78S2P1",
				"description": "DB2_Connector_66",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "Db2Source",
						"query": {
							"value": "-- BH AP\n\nSELECT\n\n        cast(AL1.CTRY_CD as char(4)) as SAP_CMPNY_CD, \n        cast(AL2.company_desc as char(50)) as SAP_CMPNY_NM,\n        cast(AL1.RGN_LVL3_CD as char(4)) as RGN_LVL3_CD, \n        cast(AL1.RGN_LVL3_NM as char(30)) as RGN_LVL3_NM,\n        cast(AL3.ISO_COUNTRY_ID as char(2)) as ISO_CTRY_CD,\n        cast(AL1.CTRY_DESC as char(50)) as CTRY_NM,\n        cast(AL3.CURRENCY_CD as char(3)) as CRNCY_CD, \n        cast(AL1.IMT_CD as char(10)) as IMT, \n        cast(AL1.CTRY_CD as char(3)) as CTRY_CD, \n        cast(AL1.RGN_LVL1_CD as char(10)) as IOT,\n        cast(AL1.RGN_LVL1_NM as char(30)) as IOT_DESC,\n        cast(CASE AL4.FAS8_IND WHEN  'Y' THEN 'Y' ELSE 'N' END as char(1)) as INFL_FLAG,\n        cast(AL1.RGN_LVL2_CD as char(2)) as IMT_CD,\n        cast(AL1.RGN_LVL2_NM as char(30)) as IMT_DESC,\n        cast(AL2.SAP_COMPANY_CD as char(4)) as BH_SAP_CMPNY_CD,\n        cast('BH' as char(3)) as APPL_IND\n\nFROM BMSIW.GEO_RGN_CTRY_UV AL1\nJOIN BMSIW.COMPANY_REF_UV AL2\n        ON AL1.CTRY_CD=AL2.COUNTRY_CD\n        --AND AL1.RGN_LVL1_CD IN ('AS', 'CG') \n        AND AL1.CTRY_CD               @{pipeline().parameters.p_IPPF_RULES_COUNTRIES_BH}\nJOIN BMSIW.COUNTRY_REF_UV AL3 \n        ON AL1.CTRY_CD=AL3.COUNTRY_CD\n        AND AL3.STATUS='O'                                    -- valid for use countries only\nLEFT JOIN BMSIW.LOC_ROLLUP_REF_UV AL4\n        ON AL1.CTRY_CD = AL4.LOC_CD where AL1.CTRY_CD!='BBB'\n\nUNION ALL\n\n--- BMS AP\n\nSELECT \n\n        cast(AL1.CTRY_CD as char(4))  as SAP_CMPNY_CD, \n        cast(AL1.CTRY_DESC as char(50))  as SAP_CMPNY_NM, \n        cast(AL1.RGN_LVL3_CD as char(4)) as RGN_LVL3_CD, \n        cast(AL1.RGN_LVL3_NM as char(30)) as RGN_LVL3_NM,\n        cast(AL2.ISO_COUNTRY_ID as char(2)) as ISO_CTRY_CD,\n        cast(AL1.CTRY_DESC as char(50)) as CTRY_NM, \n        cast(AL2.CURRENCY_CD as char(3)) as CRNCY_CD, \n        cast(AL1.IMT_CD as char(10)) as IMT, \n        cast(AL1.CTRY_CD as char(3)) as CTRY_CD, \n        cast(AL1.RGN_LVL1_CD as char(10)) as IOT,\n        cast(AL1.RGN_LVL1_NM as char(30)) as IOT_DESC,\n        cast(CASE AL3.FAS8_IND WHEN  'Y' THEN 'Y' ELSE 'N' END as char(1)) as INFL_FLAG,\n        cast(AL1.RGN_LVL2_CD as char(2)) as IMT_CD,\n        cast(AL1.RGN_LVL2_NM as char(30)) as IMT_DESC,\n        cast(AL1.CTRY_CD as char(4)) as BH_SAP_CMPNY_CD,\n        cast('BMS' as char(3)) as APPL_IND\n\nFROM BMSIW.GEO_RGN_CTRY_UV AL1\nJOIN BMSIW.COUNTRY_REF_UV AL2 \n        ON AL1.CTRY_CD=AL2.COUNTRY_CD\n        AND AL1.RGN_LVL1_CD @{pipeline().parameters.p_IPPF_RULES_RGN_LVL1_CD}\n        AND AL1.CTRY_CD                    not @{pipeline().parameters.p_IPPF_RULES_COUNTRIES_BH}\n        AND AL2.STATUS='O'                                        -- valid for use countries only\nLEFT JOIN BMSIW.LOC_ROLLUP_REF_UV AL3\n        ON AL2.COUNTRY_CD = AL3.LOC_CD where AL1.CTRY_CD!='BBB'\n\nWITH UR",
							"type": "Expression"
						}
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"dataIntegrationUnits": 2,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "ds_sourceDB2",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "ds_sourceCSV",
						"type": "DatasetReference",
						"parameters": {
							"p_fileName": "V78S2P1.csv",
							"p_folder": "LIPPFD0030_SAP_COMPANY_LOAD_INTGRT"
						}
					}
				]
			},
			{
				"name": "Transformation",
				"type": "ExecuteDataFlow",
				"dependsOn": [
					{
						"activity": "V78S2P1",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"dataflow": {
						"referenceName": "df_030",
						"type": "DataFlowReference",
						"parameters": {
							"p_IPPF_RULES_SCHEME1": {
								"value": "'@{pipeline().parameters.p_IPPF_RULES_SCHEME1}'",
								"type": "Expression"
							}
						},
						"datasetParameters": {
							"V78S2P1": {
								"p_folder": "LIPPFD0030_SAP_COMPANY_LOAD_INTGRT",
								"p_fileName": "V78S2P1.csv"
							},
							"V78S0": {
								"p_schema": {
									"value": "@{pipeline().parameters.p_IPPF_RULES_SCHEME1}",
									"type": "Expression"
								},
								"p_table": "SAP_COMPANY"
							}
						}
					},
					"integrationRuntime": {
						"referenceName": "ir-azure-DataFlow",
						"type": "IntegrationRuntimeReference"
					},
					"traceLevel": "None"
				}
			}
		],
		"parameters": {
			"p_IPPF_RULES_COUNTRIES_BH": {
				"type": "String"
			},
			"p_IPPF_RULES_RGN_LVL1_CD": {
				"type": "String"
			},
			"p_IPPF_RULES_SCHEME1": {
				"type": "String"
			}
		},
		"annotations": []
	}
}